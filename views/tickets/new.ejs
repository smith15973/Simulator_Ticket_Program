<% layout('layouts/boilerplate') %>

    <div class="container-sm mt-5">
        <h1 class="text-center">Submit a Ticket</h1>

        <form class="p-3" action="/tickets" method="POST">

            <div class="mb-3">
                <label for="originator" class="form-label">Name:</label>
                <input class="form-control" type="text" list="originators" name="originator" id="originator" required>
                <datalist id="originators">
                    <% for (let ticket of tickets) { %>
                        <option value="<%=ticket.originator%>"></option>
                        <% } %>
                </datalist>
            </div>



            <div class="mb-3">
                <label for="dateSubmitted" class="form-label">Date:</label>
                <input type="date" value="<%= new Date().toISOString().split('T')[0]  %>" class="form-control" id="dateSubmitted" name="dateSubmitted"
                    required>
            </div>

            <div class="row mb-3">
                <div class="col-sm-6">
                    <label class="form-label">Problem Captured:</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="captured" id="savedIC" value="SavedIC#"
                            required>
                        <label class="form-check-label" for="savedIC">
                            Saved IC#
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="captured" id="snapped" value="Snapped"
                            required>
                        <label class="form-check-label" for="snapped">
                            Snapped
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="captured" id="notCaptured"
                            value="Not Captured" required>
                        <label class="form-check-label" for="notCaptured">
                            Not Captured
                        </label>
                    </div>
                </div>

                <div id="capturedSlotInput" class="col-sm-6 d-none">
                    <label class="form-label" for="capturedSlot">Captured Slot:</label>
                    <input type="number" class="form-control" id="capturedSlot" name="capturedSlot" max="350" min="0">
                </div>
            </div>




            <div class="mb-3">
                <label for="title" class="form-label">Title:</label>
                <input type="text" class="form-control" id="title" name="title" required>
            </div>

            <div class="mb-3">
                <label for="description" class="form-label">Description:</label>
                <textarea class="form-control" id="description" name="description" rows="3" required></textarea>
            </div>

            <div class="mb-3">
                <label for="impactedTraining" class="form-label">Training Impacted?</label>
                <select class="form-select" name="impactedTraining" id="impactedTraining" required>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>



            <div class="mb-3">
                <label for="priority" class="form-label">Priority Level: <span data-bs-toggle="tooltip"
                        title="1: Critical to current training in development. Training cannot proceed without the problem being corrected. The initiator shall submit a condition report. &#10;2: Training can be performed but may require instructor work around. If the condition is adverse to quality of the training being performed, the initiator shall submit a condition report &#10;3: Correct when work can be performed efficiently &#10;4: Pending Reference Unit change or enhancement request">&#9432</span></label>
                <select class="form-select" id="priority" name="priority" required>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
            </div>


            <div class="mb-3">
                <label for="system" class="form-label">System:</label>
                <select class="form-select" name="system" id="system" required>
                    <option value="Hardware">Hardware</option>
                    <option value="Software">Software</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary d-block mx-auto" style="width: 200px;">Submit</button>
        </form>
    </div>

    <script>
        document.querySelectorAll('input[type="radio"][name="captured"]').forEach(function (radio) {
            radio.addEventListener('change', function () {
                var capturedSlotInput = document.getElementById('capturedSlotInput');
                if (radio.value === 'SavedIC#' || radio.value === 'Snapped') {
                    capturedSlotInput.classList.remove('d-none');
                } else {
                    capturedSlotInput.classList.add('d-none');
                }
            });
        });
    </script>